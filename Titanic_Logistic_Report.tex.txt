\documentclass[12pt]{article}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}

\lstset{
  language=Python,
  basicstyle=\ttfamily\small,
  keywordstyle=\color{blue}\bfseries,
  commentstyle=\color{green!60!black},
  stringstyle=\color{red},
  showstringspaces=false,
  breaklines=true
}

\title{Logistic Regression on Titanic Dataset: From Scratch}
\author{Your Name}
\date{\today}

\begin{document}

\maketitle

\section{Introduction}
Logistic regression is a fundamental classification algorithm used to model binary outcomes. Here, we implement it from scratch to predict survival on the Titanic dataset using features: \texttt{age}, \texttt{sex}, and \texttt{pclass}.

\section{Data Preprocessing}
Selected features:

\begin{itemize}
    \item \texttt{age} – continuous variable
    \item \texttt{sex} – categorical (male=0, female=1)
    \item \texttt{pclass} – passenger class (1,2,3)
    \item \texttt{survived} – target variable
\end{itemize}

Convert features to arrays:

\begin{lstlisting}
X = df[["age","sex","pclass"]].values
y = df["survived"].astype(int).values
\end{lstlisting}

Split dataset:

\begin{lstlisting}
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)
\end{lstlisting}

\section{Model Implementation}
Sigmoid function:

\[
\sigma(z) = \frac{1}{1 + e^{-z}}, \quad z = w_1 x_1 + w_2 x_2 + w_3 x_3 + b
\]

Gradient descent updates:

\[
w := w - \alpha \frac{\partial L}{\partial w}, \quad
b := b - \alpha \frac{\partial L}{\partial b}
\]

\section{Training and Evaluation}
Predicted probabilities:

\begin{lstlisting}
def predict_proba(self, X):
    return self.sigmoid(np.dot(X, self.weights) + self.bias)

def predict(self, X, threshold=0.5):
    return (self.predict_proba(X) >= threshold).astype(int)

accuracy = np.mean(model.predict(X_test) == y_test)
print("Test Accuracy:", accuracy)
\end{lstlisting}

\section{Visualization}
Predicted survival probability curves for different passenger types:

\begin{itemize}
    \item Red: Male, 1st class
    \item Blue: Female, 1st class
    \item Orange: Male, 3rd class
    \item Purple: Female, 3rd class
\end{itemize}

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.8\textwidth]{titanic_logistic_plot.png}
    \caption{Survival Probability vs Age for Different Passenger Types. Scatter points show actual data, curves show predicted probabilities.}
    \label{fig:logistic_plot}
\end{figure}

\section{Conclusion}
This project demonstrates:

\begin{itemize}
    \item Data preprocessing and feature encoding
    \item Sigmoid-based probabilistic modeling
    \item Gradient descent optimization
    \item Visualization of survival probability trends
\end{itemize}

\end{document}
